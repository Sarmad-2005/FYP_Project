@startuml System Sequence Diagram - Part 1: Core System Operations
!theme plain
skinparam backgroundColor #FFFFFF
skinparam participant {
    BackgroundColor #E8F4FD
    BorderColor #2E86AB
    FontColor #1A365D
}
skinparam sequence {
    ArrowColor #2E86AB
    LifeLineBackgroundColor #F7FAFC
    LifeLineBorderColor #4A5568
}

title System Sequence Diagram - Part 1
Core System Operations

actor "Project Manager" as PM
actor "Project Staff" as PS
participant "Web Browser" as WB
participant "Flask Application" as FA
participant "AI Engine" as AI
participant "Database Manager" as DM
participant "ChromaDB" as CDB
participant "LLM Manager" as LLM

== System Initialization ==

PM -> WB: Access system
WB -> FA: GET /
FA -> DM: initialize_system()
DM --> FA: System ready
FA --> WB: Render main dashboard
WB --> PM: Display system interface

== User Authentication & Role Management ==

PM -> WB: Login
WB -> FA: POST /login
FA -> DM: authenticate_user(credentials)
DM --> FA: Authentication result
alt Authentication successful
    FA -> DM: get_user_roles(user_id)
    DM --> FA: User roles
    FA --> WB: Redirect to dashboard
    WB --> PM: Display role-based dashboard
else Authentication failed
    FA --> WB: Error message
    WB --> PM: Display error
end

== Project Creation & Management ==

PM -> WB: Create new project
WB -> FA: POST /create_project
FA -> DM: create_project(project_data)
DM --> FA: Project created
FA -> AI: initialize_project_ai(project_id)
AI -> CDB: setup_project_collections(project_id)
CDB --> AI: Collections ready
AI --> FA: AI initialized
FA --> WB: Project created
WB --> PM: Display project details

== Document Upload & Processing ==

PS -> WB: Upload document
WB -> FA: POST /upload_document
FA -> AI: process_document(file, project_id)
AI -> AI: extract_text_from_pdf(file)
AI -> AI: generate_embeddings(text)
AI -> CDB: store_embeddings(project_id, embeddings)
CDB --> AI: Embeddings stored
AI -> DM: save_document_metadata(project_id, document_data)
DM --> AI: Document saved
AI --> FA: Document processed
FA --> WB: Success response
WB --> PS: Display success

@enduml





